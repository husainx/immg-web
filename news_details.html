<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>News Details - Maldives Immigration</title>

    <link rel="stylesheet" href="assets/css/style.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=IBM+Plex+Sans:wght@400;500;600;700&display=swap"
      rel="stylesheet"
    />

    <script src="https://cdn.tailwindcss.com?plugins=forms,typography,aspect-ratio,line-clamp"></script>
    <script
      defer
      src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"
    ></script>
    <script src="assets/js/tailwind-config.js"></script>

    <style>
      [x-cloak] {
        display: none !important;
      }
      .skeleton {
        position: relative;
        overflow: hidden;
        background-color: rgb(241 245 249);
      }
      .skeleton::after {
        content: "";
        position: absolute;
        inset: 0;
        transform: translateX(-100%);
        background: linear-gradient(
          90deg,
          rgba(241, 245, 249, 0) 0%,
          rgba(226, 232, 240, 0.8) 50%,
          rgba(241, 245, 249, 0) 100%
        );
        animation: shimmer 1.2s infinite;
      }
      @keyframes shimmer {
        to {
          transform: translateX(100%);
        }
      }
    </style>
  </head>
  <body class="text-darkGray">
    <div id="header-light"></div>

    <main role="main" aria-label="News details">
      <section
        class="py-12"
        x-data="newsDetails()"
        x-init="fetchPost()"
        x-cloak
      >
        <div class="max-w-6xl mx-auto px-4">
          <div class="flex items-center gap-3 text-sm text-slate-600">
            <a
              href="news.html"
              class="inline-flex items-center gap-2 hover:underline"
            >
              <svg
                xmlns="http://www.w3.org/2000/svg"
                class="h-4 w-4"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path
                  stroke-linecap="round"
                  stroke-linejoin="round"
                  stroke-width="1.5"
                  d="M10.5 19.5 3 12l7.5-7.5M3 12h18"
                />
              </svg>
              Back to News
            </a>
          </div>

          <!-- Hero / title -->
          <div class="mt-6 grid grid-cols-1 md:grid-cols-12 gap-6">
            <template x-if="loading">
              <div
                class="md:col-span-12 grid grid-cols-1 md:grid-cols-12 gap-6"
              >
                <div class="md:col-span-6">
                  <div class="skeleton rounded-xl aspect-video"></div>
                </div>
                <div class="md:col-span-6 flex flex-col justify-between">
                  <div>
                    <div class="skeleton h-7 w-4/5 rounded mb-3"></div>
                    <div class="skeleton h-7 w-2/3 rounded"></div>
                  </div>
                  <div class="skeleton h-4 w-24 rounded mt-6"></div>
                </div>
              </div>
            </template>

            <template x-if="!loading && post">
              <div
                class="md:col-span-12 grid grid-cols-1 md:grid-cols-12 gap-6"
              >
                <div class="md:col-span-6">
                  <img
                    :src="post.image"
                    :alt="post.title"
                    class="w-full h-full rounded-xl object-cover aspect-video"
                  />
                </div>
                <div class="md:col-span-6 flex flex-col justify-between">
                  <div>
                    <h1
                      class="text-2xl md:text-3xl font-bold text-slate-900"
                      x-text="post.title"
                    ></h1>
                    <p class="text-slate-600 mt-3" x-text="post.excerpt"></p>
                  </div>
                  <div
                    class="flex items-center gap-4 mt-6 text-xs text-slate-500"
                  >
                    <span x-text="post.date"></span>
                    <span>&middot;</span>
                    <span x-text="post.readTime"></span>
                  </div>
                </div>
              </div>
            </template>
          </div>

          <!-- Article body -->
          <div class="mt-12">
            <template x-if="loading">
              <div class="space-y-3">
                <div class="skeleton h-4 w-5/6 rounded"></div>
                <div class="skeleton h-4 w-full rounded"></div>
                <div class="skeleton h-4 w-11/12 rounded"></div>
                <div class="skeleton h-4 w-4/5 rounded"></div>
                <div class="skeleton h-4 w-2/3 rounded"></div>
              </div>
            </template>

            <article
              class="prose prose-slate max-w-none"
              x-show="!loading"
              x-transition
            >
              <h2 class="text-slate-900">Overview</h2>
              <p x-text="post.body.overview"></p>

              <h3>Key Points</h3>
              <ul>
                <template x-for="(p, idx) in post.body.points" :key="idx">
                  <li x-text="p"></li>
                </template>
              </ul>

              <h3>Details</h3>
              <p x-text="post.body.details"></p>

              <blockquote x-text="post.body.quote"></blockquote>
            </article>
          </div>

          <!-- Share -->
          <div class="mt-10 flex items-center gap-3 text-sm">
            <span class="text-slate-500">Share:</span>
            <a
              :href="share('facebook')"
              class="inline-flex p-2 rounded-md border hover:bg-slate-50"
              aria-label="Share on Facebook"
              ><img
                src="assets/images/facebook.svg"
                class="w-4 h-4"
                alt="facebook"
            /></a>
            <a
              :href="share('twitter')"
              class="inline-flex p-2 rounded-md border hover:bg-slate-50"
              aria-label="Share on X"
              ><img
                src="assets/images/twitter.svg"
                class="w-4 h-4"
                alt="twitter"
            /></a>
          </div>

          <!-- Related -->
          <div class="mt-14">
            <h3 class="text-lg font-semibold text-slate-900">
              Related articles
            </h3>
            <div
              class="mt-4 grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-6"
            >
              <template x-if="loading">
                <template x-for="i in 3" :key="i">
                  <div class="rounded-2xl border border-slate-200 bg-white p-4">
                    <div class="skeleton rounded-lg mb-4 aspect-[4/3]"></div>
                    <div class="skeleton h-4 w-3/5 rounded mb-2"></div>
                    <div class="skeleton h-3 w-4/5 rounded"></div>
                  </div>
                </template>
              </template>

              <template x-if="!loading">
                <template x-for="item in related" :key="item.id">
                  <article
                    class="rounded-2xl border border-slate-200 bg-white p-4 hover:shadow-sm cursor-pointer"
                    @click="go(item.url)"
                  >
                    <div
                      class="rounded-lg bg-indigo-200 aspect-[4/3] flex items-center justify-center text-indigo-700 font-semibold mb-4"
                    >
                      Image
                    </div>
                    <h4
                      class="text-sm font-semibold text-slate-900 line-clamp-2"
                      x-text="item.title"
                    ></h4>
                    <p
                      class="text-xs text-slate-500 mt-2"
                      x-text="item.date"
                    ></p>
                  </article>
                </template>
              </template>
            </div>
          </div>
        </div>
      </section>
    </main>

    <div id="footer"></div>

    <script src="assets/js/components.js"></script>

    <script>
      function newsDetails() {
        return {
          loading: true,
          post: null,
          related: [],
          go(url) {
            window.location.href = url;
          },
          share(network) {
            const url = encodeURIComponent(window.location.href);
            const text = encodeURIComponent(this.post?.title || "");
            if (network === "facebook")
              return `https://www.facebook.com/sharer/sharer.php?u=${url}`;
            if (network === "twitter")
              return `https://twitter.com/intent/tweet?url=${url}&text=${text}`;
            return "#";
          },
          async fetchPost() {
            this.loading = true;
            const params = new URLSearchParams(window.location.search);
            const id = Number(params.get("id") || "0");
            await new Promise((r) => setTimeout(r, 500));

            const makeItem = (id) => ({
              id,
              kicker: "IMUGA TRAVELLER DECLARATION",
              title: `Foreign nationals visiting the Maldives as tourists receive a free 30-day visa on arrival ${id}`,
              excerpt:
                "Foreign nationals visiting the Maldives as tourists receive a free 30-day visa on arrival. This applies to most nationalities and can be extended.",
              date: "24 April 2025",
              readTime: "3 min read",
              image:
                "https://www.immigration.gov.mv/wp-content/uploads/2025/06/photo_6260334332421981930_y-1.jpg",
              url: `news_details.html?id=${id}`,
              body: {
                overview:
                  "This article provides an overview of the policy update along with guidance for visitors and employers.",
                points: [
                  "Visa on arrival policy remains unchanged",
                  "Extensions available through proper application",
                  "Ensure passport validity and onward ticket",
                ],
                details:
                  "Authorities conducted scheduled operations and coordinated across agencies to ensure regulatory compliance and public awareness.",
                quote:
                  "“Our priority is safe and orderly migration while facilitating legitimate travel.”",
              },
            });

            const all = Array.from({ length: 12 }, (_, i) => makeItem(i + 1));
            const fallbackFeatured = {
              id: 0,
              title:
                "Raid Operation in R. Dhuvaafaru Results in Detention of 51 Illegal Expatriates",
              excerpt:
                "A coordinated operation led to the detention of 51 individuals found in violation of immigration regulations.",
              date: "24 April 2025",
              readTime: "4 min read",
              image:
                "https://www.immigration.gov.mv/wp-content/uploads/2025/06/photo_6260334332421981930_y-1.jpg",
              url: "news_details.html?id=0",
              body: {
                overview:
                  "Authorities have announced the results of a targeted enforcement initiative.",
                points: [
                  "51 individuals detained",
                  "Multi-agency collaboration",
                  "Ongoing verification procedures",
                ],
                details:
                  "The operation focused on hotspots identified through prior assessments and community reporting.",
                quote:
                  "“We thank the public for their cooperation and encourage continued reporting of violations.”",
              },
            };

            this.post =
              id === 0
                ? fallbackFeatured
                : all.find((a) => a.id === id) || all[0];
            this.related = all.filter((a) => a.id !== this.post.id).slice(0, 3);
            this.loading = false;
          },
        };
      }
    </script>
  </body>
</html>
